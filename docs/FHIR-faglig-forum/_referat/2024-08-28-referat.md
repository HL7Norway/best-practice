---
layout: default
title: Referat FHIR fagforum møte nr 25
motenr: 25
dato: 2024-08-28
tema: SMART on FHIR  
---

# Møte 25 i FHIR fagforum

* Dato: 2024-08-28
* Klokkeslett: 1300-1500
* 72 personer innom møtet virtuelt

FHIR fagforum (FFF) er et åpent forum om bruk og implementering av HL7 FHIR i Norge. FFF er åpent for alle.

## Agenda: SMART on FHIR

1. Info from HL7 Norway and welcome to fagforum, Thomas og Øyvind 10 min
1. Webmed implementasjon av SMART on FHIR, Jarle Hjortland (Webmed AS) 25 min
1. NAV sitt arbeid med SMART on FHIR, Erik Haug og Leo-Andreas Ervik (NAV) 25 min
1. DIPS sitt arbeid med SMART on FHIR, Sverre Coucheron (DIPS AS) 20 min
1. Helsedirektoratet sitt arbeid med SMART on FHIR, Merete Lassen og Frank Braathen (Helsedirektoratet) 20 min
1. Finnish IG on SMART on FHIR, Mikael Rinnetmaki (HL7 Finland), 10 min
1. Discussion 10 min

## Presentasjoner

* [FHIR fagforum intro](../docs/FHIR-faglig-forum/presentasjon/2024-06-12-FHIR-fagforum-25.pdf)

## HL7 Norge

* 1 million kroner til HL7 Norway.  
* WGM+ i Atlanta
* Arbeid og høring på nasjonale domeneprofiler AuditEvent og Vitale parametere

## Webmed, Jarle Hjortland

### Behov

* partnerintegrasjoner uten lange utviklingsløp.
* Historikk, ønske om å ta i bruk i Førerrettprosjektet.
* Legene ønsker ikek å forholde seg til flere klientapplikasjoner.
* Sikkerhet for at applikasjon kan hente ut data fra EPJ på en trygg måte.
* Tegn på og nasjonal anbefaling å bruke HL7 FHIR standarden

### Førerrett prosjektet

* Prosjektet var kommet langt.
* Funding fra EPJ løftet.
* 6mnd for å levere første versjon av implementasjonen
* 3 partnere Webmed, NHN og Vegvesenet.
* 1300 førerrett attester til Vegvesenet hver måned.
  * Gevinsten er hentet ut.

### Arkitektur i Webmed

* Førerrett utvikling
  * Firely fasad, utvikle selv eller Microsoft FHIR server
  * Valgte Microsoft FHIR server - SFM bruker også dette
* Autentisering
  * Implementert på FHIR IdentityServer 4
  * Utveksler Launch context og claims
  * I løpet av året må oppgraderes til Duende IdentityServer
* FHIR API
  * Implementert som fasade mot WebMed Backend
  * Token inneholder informasjon om kunde/backend som skal bruke data
  * Persistence layer bruker Odata mot Webmed backend
  * Ett felles FHIR API for alle kunder

### Utforderinger

* Tar lang tid for nye utviklere å sette seg inn i prosjektet og FHIR
  * Krevende opplæring og trening.
* Webmed tilgjengelig på helsenett eller VPN
  * De som lager smartapp har ikke helsenett
  * Løsning to sett med identity servere på internet og helsenett
  * FHIR fasade på internett med IP whitelist
  * Backend tillater tokens fra både internett og helsenett
* Kun behovene for førerrett er støttet i API'ene
* Havner fort bak i forhold til oppdateringer på Microsoft FHIR server og andre produkter i kjeden
  * Krevende å holde oppdatert
* Når backend og servere oppdateres fungerer da appene etterpå?

### Nye smart APP'er

* To apper i produksjon
  * Spirare og Førerrett
* Pilot
  * Brain Twin
* Test
  * Afail transkribering
* Under utvikling

### SPirare tilbakemeldinger

* Spirare bruker FHIr som datamodell
* Skulle ønske at flere brukte HL7 FHIr og SMART.

### Questions

Q: behov for videreutvikle FHIR Api med integrasjon i Spirare?
Svar: De fleste trenger kontekst (pasient etc.) og legge resultater tilbake. Notat appen trenger noe mer funksjonalitet. Noen prosjekter har vi satt nei til fordi vi ikke har API'ene. Ønsker å gjøre ting.

Q: Når man har støtte for en app, hvor mye gjenbrukes i neste app?
Svar: Sette opp ny app tar 30 minutter, det som tar tid er opplæring i FHIR/SMART on FHIR. Veldig enkelt å sette opp, ny URL og sette opp sikkerhetsregimet

Q: Hvordan synes du integrasjonen mot Spirare, Noteless vs Førerrett i forhold til dokumentasjon.
Svar: Spirare EKG kommer tilbake, Førerrett svar kommer tilbake men notatapp sender bare tilbake FHIR vedlegg (sier ikke brukeren noe i siste tilfelle).

Q: Sikkerhet og test av apper i forhold til at de ikke gjør noe de ikke skal inn mot API/Webmed.
Svar: Vi gir bare tilganger og åpner for så lite som mulig, avtalene med tredjeparts leverandører må regulere dette.

Q: Tilgangskontroll og autentisering, basert på HelseID, regionene har andre metoder for tilgangskontroll? Flere token regimer.
Svar: Webmed sitt tokenregime, brukeren må logge på webmed med HelseID bruker til syvende og sist er det personnummeret som styrer tilgang.  

## NAV's erfaringer med SMART on FHIR

### Behov for informasjonutveksling mellom NAV og helse

* Kommunikasjon med fastlege, sykemelding, sykepenger, arbeidsavklaring etc.
* Men mange tema og mange ulike virksomheter innen helse.

### Pilot pleiepenger sykt barn

* Helse-Vest, NAV og DIPS
* Skjemaløsning

### Strategi

* Gjennomføring
  * Nav tar ansvar fo rgjennomføring og utrulling til helsetjenesten
    * Tverfaglige team med helsepersonell, brukere og NAV
* Løsning
  * Nav lager løsningene som skal brukes av helsepersonell
    * Smart
    * Selvstendig Webapp
* Utvikling av ny sykemelding
  * utvikling starter høst 2024

### Intensjon

* SMART on FHIR krav til det norske markedet fra NAV sitt perspektiv
* Gjelder mest SMART og ikke så mye FHIR
* Det er komplisert...

### Ktegorier for SMART on FHIR

* Oppstart av SMART app
* Hente informasjon fra FHIR server/API
* Sende/hente data utenfor tilbyder av EPJ
  * Sende sykemelding til NAV sin backend

### Oppstart

* smart config endepunkt
* EPJ smart configurator følger minimumskravene
* God praksis er at SMART apper initialiseres fra launch endepunkt
  * Fra SMART får de bare id, trenger HPR og HER id mend et kan de få fra FHIR serveren.

#### Utfordringer med oppstartsfasen

* OAuth 2 er tydelig definert og bruk innenfor SMART
* id_token inneholder ikke nødvendig informasjon for oppstart av NAV applikasjonen
* EPJ-spesifikk navngivning av elementer fører til mange konfigurasjoner av samme app
* Manglende påkrevde felter i well-known/smart-config
  * Uthenting av data prefikses med FHIRresurs/id

#### Utfordringer med access token

* Kortlevd tilgang til ressurs fra en database
  * Data kan være endret innenfor levetiden til token
* ID matcher ikke ressursene på FHIR serveren

#### Utveksling av data fra EPJ

* Nav må kunne verifisere token som brukes it lå åhente data fra FHIr server (JWT token)
* Variasjoner i nettverksoppsett og sikkerhetsforvenintinger hos aktører
* Hvordan sende informasjon mellom legekontor og NAV innenfor et zero trust rammeverk.

### NAV har utviklet en SMART on FHIR app for SMART compliance

* Open source på Github
* SMART launcher
  * Sier hva som mangler og gir warnings
  * Legen har ikke norsk HPR nummer
  * Pasient har ikke fødselsnummer

Økt konkurranse og innovasjon, økt automatisering

## DIPS, Sverre Coucheron

### Open DIPS



### Questions

